# FD Poison
## File Structure
- exercise/: The first 'fd' poison challenge
    - start.py: The starting point for the challenge
    - final.py: Full working POC for the challenge
    - fake_fd.c: The source code for the challenge
    - fake_fd: The binary for the challenge
    - Makefile: Compilation script for the challenge
- challenge2/: A harder CTF-like fd poison challenge
    - start.py: The starting point for the challenge. The initial challenge is for GLibC 2.26.
    - happy.c: The source code for the challenge
    - happy: The binary for the challenge
    - Makefile: Compilation script for the challenge
    - versions: A plethora of other versions of the challenge
        - A checkpoint system is used from 'start.py' through step1, step2, step3 and final
        - solution_mangle.py: The solution for the challenge with pointer mangled enabled
        - solution_fastbin.py: The solution for the challenge while using fastbins with version 2.23
- FdPoison.pptx: The slides for the technique

## Flow of Folder
- Go through the slides until the exercise is mentioned.
- Do exercise1 first. Start with ``start.py`` until the challenge has been completed. 
- Finish the slides.
- Go through challenge1:
    - Start off by reading the source code and finding the vulnerability.
    - A pwntools interface for the challenge has already been written for you in step0.py
    - Do each step of the challenge (shown below): 
        - If you get stuck (like, really stuck) then review the solution for the step then move on
          to the next step.
        - Move onto the next step with the ``grab`` command in the repo.
- Steps for challenge1: 
    - Finding the vulnerability (step1) 
    - Leak a heap address (step2) 
    - Create fake chunk in tcache (step3)
    - Use the fake chunk to overwrite function pointer with easy shell (final)
    - Finished :)
- Once you have finished challenge2 with tcache, try the harder versions (Optional):
    - fastbin (2.23): Has additional security checks on the next chunk size. Only requires small modifications.
    - pointer mangling (2.32): Has new 'fd pointer' security. Use the heap leak to bypass this technique. 
