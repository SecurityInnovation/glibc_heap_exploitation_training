
/*
Stores the header information for each header

header_name: header_value
*/
struct header {
    char* name; // Key of the header (name)
    char* value; // Value of the header
    void* hook; // Add in custom functionality for a particular header
} header; 

// The first line of an HTTP request
struct request {
    char protocol_no[0x20]; 
    char verb[0x20]; // GET, POST, etc.
    uint path_len; 
    char* path; //   /some_path
    uint query_amount; 
    struct query* query_params[0x10]; // ?a=1&b=2;
} request; 

struct query {
    char name[0x20]; // 'key'
    char value[0x20]; // 'value'
} query; 

enum req_type {NONE = 0, PLAIN = 1, FORM=2, HTML=3};
struct body {
    uint length; 
    enum req_type type; 
    void* data_object; // char* for PLAIN - form_body for FORM
} body;

struct form_body{
    int count; // Amount of forms
    struct query* query_params[0x10]; // ?a=1&b=2
} form_body;


// The context of the request
struct context {
    char* host; 
    char* user_agent;
    char* origin; 
} context;

// The response of the request to be sent back
struct response {
    int status;  // SecDo: Uninitialize memory problem!
    char* response_text;
} response;

typedef  char* (*hit_route)();
struct route {
    char verb[0x20]; // Verb for the route
    char* route;        // The string for the route
    hit_route handle_callback;  // When the request is hit, call this functionality
} route; 

// A pointer to a list of pointers of routes
struct route** routes; 

// The main area where the request information is stored at
struct request* begin_request; 
struct header* req_header_lst[0x20];
struct header* res_header_lst[0x20];

struct body* body_request; 

struct response* whole_response; 

// Function declariations
int serve(int sockfd);
int initialize_server(struct route** my_routes);


