# Shell path to GCC
ifeq (${OS},Linux)
CC := $(shell which gcc)
CXX := $(shell which g++)
endif

# Debugging flags
CFLAGS := "-O0"
CFLAGS += "-g3"
CFLAGS += "-ggdb"
CFLAGS += "-Wunused-result"
#CFLAGS += "-no-pie"

# Instrumentation flags
#CFLAGS += " -fsanitize=address -Wconversion"

SRC_FILE := "src/example.c"
SRC_FILE += "src/utils.c"
SRC_FILE += "src/server.c"
OUT_FILE := "src/server"

##############################

all: build

build:
	@ ${CC} ${SRC_FILE} -o ${OUT_FILE} ${CFLAGS}

build_asan: 
	@ ${CC} ${SRC_FILE} -o ${OUT_FILE} ${CFLAGS} -fsanitize=address
clean:
	@ rm ${OUT_FILE}

.PHONY: all build clean
