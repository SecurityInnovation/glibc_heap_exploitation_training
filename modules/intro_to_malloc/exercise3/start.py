from pwn import * 

mode = 'DEBUG' # Turn on gdb
libc_name='../../../libc_versions/2.23/libc-2.23.so'
env = {}

# Binary setup
elf_name = './.birdie'

elf = ELF(elf_name)
if libc_name != '':
        libc = ELF(libc_name)
        env = {"LD_PRELOAD": libc.path}

# Process creation 
if mode == 'DEBUG':
        p = process([elf.path],env=env)
        gdb.attach(p, gdbscript='''
dir ../../../libc_versions/2.23/
''')

'''
NOT REQUIRED TO USE
PLEASE.... it is MUCH easier to just use the interactive CLI for this
'''
# Malloc
def malloc():
	p.sendlineafter(">", "1") 

# Free
def free():
	p.sendlineafter(">", "2") 

p.interactive()
