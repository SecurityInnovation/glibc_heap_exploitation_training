#!/usr/bin/env python3
'''
Mmap chunk Overlapping run POC in proper ENV
'''

from pwn import * 
import os

mode = 'DEBUG' # Turn on gdb
libc_name = '../../../libc_versions/2.31/libc-2.31.so'
env = {}

# Binary setup
elf_name = '.start'

elf = ELF(elf_name)
if libc_name != '': 
	libc = ELF(libc_name)
	env = {"LD_PRELOAD": libc.path}
	
# Process creation 
if mode == 'DEBUG': 
	p = gdb.debug([elf.path],env=env, gdbscript='''
dir ../../../libc_versions/2.31/
b main
''')
else: 
	p = remote(domain, port) 

# Press enter to continue
p.sendline("\n")

p.interactive()


