#!/usr/bin/env python3
'''
House of Force Starter

Fill out the TODO's:
- Corrupted top chunk size (step 1) 
- Chunk size for LARGE allocation (step 2) 
'''

from pwn import * 

mode = 'DEBUG' # Turn on gdb
libc_name='../../../libc_versions/2.31/libc-2.31.so'
env = {}

# Binary setup
elf_name = './.unsafe_unlink-2.31'

elf = ELF(elf_name)
if libc_name != '': 
	libc = ELF(libc_name)
	env = {"LD_PRELOAD": libc.path}
	
# Process creation 
if mode == 'DEBUG': 
	p = gdb.debug([elf.path], env=env, gdbscript='''
dir ../../../libc_versions/2.23/ 
''') 

else: 
	p = remote(domain, port) 

p.interactive()

