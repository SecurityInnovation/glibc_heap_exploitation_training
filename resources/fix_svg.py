#!/usr/bin/env python3

#!/usr/local/bin/python3

import xml.etree.ElementTree as ET
import sys 
from os.path import basename, normpath, exists

PATH="/Users/maxdulin/Documents/Research/heap_workshop/pictures/"

if(len(sys.argv) < 2): 
    print("fix_svg <in> <out>")
    sys.exit(1) 

in_file = sys.argv[1]

# Use the same name as the original SVG unless a new name has been specified
if(len(sys.argv) < 3):
    out_file = PATH + basename(normpath(in_file))
else: 
    out_file = PATH + sys.argv[2]

print(out_file)

# Validating that the file exists
if(not exists(in_file)):
    print("Input file does not exist")


# Parse the XML file
tree = ET.parse(in_file)
root = tree.getroot()

# Find the right element
for element in root: 

    # Only remove the node with the text in the middle of it for the unsupported version stuff
    if(element.tag == "{http://www.w3.org/2000/svg}switch"):
        root.remove(element) 

# Write out the edited svg 
# Output to my pictures directory
with open(out_file, 'wb') as f:
    tree.write(f) 
