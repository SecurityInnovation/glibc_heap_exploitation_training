import os 
import sys
import shutil

if(len(sys.argv) < 2): 
	print("pop <version_number> || count || final") 
	sys.exit(1) 

# Get current directory 
d = os.getcwd()
d += "/versions"

# Check if this directory exists
if(not os.path.exists(d)):
	print("Go to a challenge location") 
	sys.exit(1) 

# Get amount of files in the path
count = 0
for path in os.listdir(d):
	if os.path.isfile(os.path.join(d, path)):
		count += 1

# If they want the number of stages
if(sys.argv[1] == 'count'): 
	print("There are " + str(count - 1) + " files here")
	sys.exit(0)

# If they want the final version
if(sys.argv[1] == 'final'): 
	filename = d + "/" + "final.py"
	shutil.copyfile(filename, "./final.py") 
	sys.exit(0) 
	
# Check to see if the first parameter is in range
if(sys.argv[1] < 0 and sys.argv[1] > count): 
	print("Too large of a version") 
	sys.exit(1) 

# Get filename 
filename = d + "/" + "stage" + str(sys.argv[1]) + ".py"
if(not os.path.exists(filename)):  # Validate file exists
	print("Stage does not exist") 
	sys.exit(1) 

shutil.copyfile(filename, "./stage" + str(sys.argv[1] + ".py"))
