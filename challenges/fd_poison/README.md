# FD Poison
## File Structure
- challenge1/: The first 'fd' poison challenge
    - step0.py: The starting point for the challenge
    - final.py: Full working POC for the challenge
    - fake_fd.c: The source code for the challenge
    - fake_fd: The binary for the challenge
    - compile.sh: Compilation script for the challenge
- challenge2/: A harder CTF-like fd poison challenge
    - step0.py: The starting point for the challenge. The initial challenge is for GLibC 2.26.
    - happy.c: The source code for the challenge
    - happy: The binary for the challenge
    - compile.sh: Compilation script for the challenge
    - versions: A plethora of other versions of the challenge
        - A checkpoint system is used from 'start.py' through step1, step2, step3 and final
        - final_2.32.py: The solution for the challenge with pointer mangled enabled
        - final_fastbin.py: The solution for the challenge while using fastbins with version 2.23
- FdOverwrite.pptx: The slides for the technique

## Flow of Folder
- First, read through the slides. 
- Do challenge1 first. Start with ``step0.py`` until the challenge has been completed. 
- Go through the TCache 2.26 version of the challenge: 
    - Start off by reading the source code and finding the vulnerability.
    - A pwntools interface for the challenge has already been written for you in step0.py
    - Do each step of the challenge (shown below): 
        - If you get stuck (like, really stuck) then review the solution for the step then move on
          to the next step.
- Steps for challenge 2: 
    - Finding the vulnerability (step1) 
    - Leak a heap address (step2) 
    - Create fake chunk (step3)
    - Use the fake chunk to overwrite function pointer with easy shell (final)
    - Finished :)
- Once you have finished challenge2 with tcache, try the harder versions: 
    - fastbin (2.23): Has additional security checks on the next chunk size. Only requires small modifications.
    - pointer mangling (2.32): Has new 'fd pointer' security. Use a leak to bypass this technique. 
