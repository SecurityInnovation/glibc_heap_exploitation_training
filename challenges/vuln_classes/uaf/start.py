from pwn import * 

mode = 'DEBUG' # Turn on gdb
libc_name='../../../libc_versions/2.26/libc-2.26.so'
env = {}

# Binary setup
elf_name = './.high_score'

elf = ELF(elf_name)
if libc_name != '':
        libc = ELF(libc_name)
        env = {"LD_PRELOAD": libc.path}

# Process creation 
if mode == 'DEBUG':
        p = process([elf.path],env=env)
        gdb.attach(p, gdbscript='''
dir ../../../libc_versions/2.26/
''')


def create(name):
	p.sendlineafter(">", "malloc")
	p.sendlineafter(":", name)

def reset():
	p.sendlineafter(">", "free") 

def won(): 
	p.sendlineafter(">", "won") 

def new():
	p.sendlineafter(">", "play") 


'''
When looking for use after free bugs, check for the following things: 
- Malloc & free operations
- Whether pointers are cleaned up after a free (dangling pointer) 
'''
p.interactive()
