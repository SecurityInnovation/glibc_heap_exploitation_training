from pwn import * 

mode = 'DEBUG' # Turn on gdb
libc_name='../../../libc_versions/2.23/libc-2.23.so'
env = {}

# Binary setup
elf_name = './.fix_fastbin'

elf = ELF(elf_name)
if libc_name != '':
        libc = ELF(libc_name)
        env = {"LD_PRELOAD": libc.path}

# Process creation 
if mode == 'DEBUG':
        p = process([elf.path],env=env)
        gdb.attach(p, gdbscript='''
dir ../../../libc_versions/2.23/
''')


# If the previous chunk is IN use, what should this value be? 
prev_size = p64(0xFFFFFFFFFFFF) # <---------------------- Change here


# What was the previous size of the chunk, with the metadata? 
# HINT: The SIZE of the chunk is 0x50 (not 0x40) - but more on this later
size = p64(0xFFFFFFFFFFFF) # <------------------- Change here
p.sendline(prev_size + size) # <---- Send the data for the chunk
p.interactive()
